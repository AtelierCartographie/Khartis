& {
    @extend %flow;
    @extend %vertical;
    @extend %outer;
    @extend %full;
}

$spreadsheet-cell-width: 140px !default;
$spreadsheet-cell-height: 30px !default;
$spreadsheet-cell-header-height: 50px !default;
$spreadsheet-numbering-width: 30px !default;

.toolbar {
    @extend %flow;
    @extend %horizontal;
    @extend %solid;
    @extend %center;
    @extend %middle;
    @extend %airy;
    @extend %padded-v;
    @extend .filled.default;
    height: 40px;
    .tool {
        height: 100%;
        width: 30px;
        text-align: center;
        cursor: pointer;
        
        /* TODO : REMOVE */
        padding-top: 5px;
        background-color: green;
        color: white;
    }
}

.sheet {
    
    @extend %flow;
    @extend .filled;
    
    overflow: scroll;
    
    & > .header {
        @extend .filled.contrast;
        @extend .with-relief;
        @extend .with-relief.topbar;
        position: absolute;
        top: 0px;
        left: 0px;
        padding-left: $spreadsheet-numbering-width;
        .cell {
            height: $spreadsheet-cell-header-height;
            border-bottom: none;
        }
        .cell .meta-icons {
            @extend %flow;
            @extend %solid;
            @extend %vertical;
            @extend %middle;
            @extend %breakable-reverse;
            @extend %right;
            @extend %airy;
            
            align-content: flex-start;
            height: $spreadsheet-cell-header-height;
            padding-top: 2px;
            padding-bottom: 2px;
            
            & *[class^="icon-"] {
                @extend %solid;
                width: 18px;
                height: 18px;
                margin: 2px;
                background: red;
            }
        }
    }
    
    & > .body {
        @extend .filled;
        position: absolute;
        top: $spreadsheet-cell-header-height;
        left: $spreadsheet-numbering-width;
    }
    
    & > .numbering, & > .dash {
        
        position: absolute;
        top: 0px;
        left: 0px;
        
        .cell {
            width: $spreadsheet-numbering-width;
        }
        
    }
    
    & > .numbering {
        @extend .filled.contrast;
        @extend .with-relief;
        @extend .with-relief.leftbar;
        padding-top: $spreadsheet-cell-header-height;
        .cell { border-right: none; }
    }
    
    & > .dash {
        @extend .filled.warning;
        @extend .with-relief;
        @extend .with-relief.leftbar;
        .cell {
            border: none;
            height: $spreadsheet-cell-header-height;
        }
    }
    
    .row {
        @extend %flow;
        @extend %horizontal;
    }
    
    .cell {
        
        @extend %flow;
        @extend %horizontal;
        @extend %middle;
        @extend %padded;
        
        width: $spreadsheet-cell-width;
        height: $spreadsheet-cell-height;
        
        border-bottom: 1px solid #D0D0D0;
        border-right: 1px solid #D0D0D0;
        
        .label {
            @extend %fluid;
            overflow: hidden;
            white-space: nowrap;
        }
        
        input {
            @extend %fluid;
            border: none;
            display: none;
            margin-left: -$gutter/2;
            margin-right: -$gutter/2;
        }
        
        &.selected { border: 1px solid $color-primary; }
        &.edited input { display: flex; }
        &.edited .label { display: none; }
        
    }
    
    /* RESIZE */
    
    $resize-handle-width: 0.6rem !default;
    
    & > .resizer {
        
        display: none;
        position: absolute;
        width: $resize-handle-width;
        height: 100%;
        
        &.dragged {
            display: block;
            border-right: 1px solid $color-primary;
        }
 
    }
    
    & > .resizer {
        pointer-events: none;
    }
    
    & > .resizer .handle, & > .header .resize-handle {
        @extend .filled.primary;
        position: absolute;
        top: 0;
        right: 0;
        width: $resize-handle-width;
        height: $spreadsheet-cell-header-height;
        cursor: e-resize;
    }
    
    & > .header .resize-handle {
        display: none;
        right: -1px;
    }
    
    & > .header .cell:hover .resize-handle {
        display: block;
    }
    
    & > .header .cell.resizing:hover .resize-handle {
        display: none;
    }
    
}